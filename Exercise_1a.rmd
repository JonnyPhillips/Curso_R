---
title: "Analysis, Visualization and Mapping in R"
subtitle: "Exercise 1: Produce a quick ready-to-share analysis using cepespata"
output: 
  html_document:
    code_folding: hide
---

```{r setup, echo=FALSE, warning=FALSE, message=FALSE}
knitr::opts_chunk$set(include=TRUE, warning=FALSE, message=FALSE, eval=FALSE)
```

1. Create a project in Rstudio.
2. Install and load the 'tidyverse' and 'knitr' packages
```{r}
#install.packages("tidyverse") #Explain comments
library(tidyverse)
library(knitr)
```

3. Download a CSV from [cepesp.io](cepesp.io) to your project file. Use the 'Eleicoes por Cargo' tab with the default options and the file should include the results of the 2014 Preidential election aggregated for the whole of Brazil.
4. Create a new Rmarkdown file. 
5. Import the CSV to Rstudio.
```{r}
pres_2014_elec_results <- read_csv("TSE_PRESIDENTE_BR_CANDIDATO_2014.csv")
```

6. Calculate the vote share of each candidate. 
```{r}
pres_2014_elec_results <- pres_2014_elec_results %>% 
  group_by(NUM_TURNO) %>% 
  mutate(Vote_Share=100*(QTDE_VOTOS/sum(QTDE_VOTOS)))
```

7. Produce a text which explains which candidate won the election, and what percentage of the vote they received. 
8. Produce a table which shows the results of the first round of the election, including vote share.
```{r}
pres_2014_elec_results %>% 
  filter(NUM_TURNO==1) %>% 
  kable()
```

9. Produce a bar chart which shows the results of the second round of the election by vote share.

```{r}
pres_2014_elec_results %>% 
  filter(NUM_TURNO==2) %>% 
  ggplot() + 
  geom_col(aes(x=NOME_CANDIDATO,y=Vote_Share))
```

10. Specify whether you want the processing code to show up in your final document.
```{r}
#Place this line in a chunk at the start of your code to make sure only the outputs appear
knitr::opts_chunk$set(echo=FALSE, warning=FALSE, message=FALSE)
```

11. Produce a PDF which combines all your outputs (text, table, chart).
12. Produce a web page which combines all your outputs (text, table, chart).
